<script type="text/x-red" data-help-name="loop">
    <p>Repeats a task in the loop specified times or by a condition or by an iterable enumeration (Array, Typed Array, Object, Map, Set, String).</p>
    <h3>Input</h3>
    <dl class="message-properties">
        <dt>count <span class="property-type">number</span></dt>
        <dd>Count of passes for the <em>fixed count</em> kind.</dd>
        <dt>initial <span class="property-type">number</span></dt>
        <dd>Initial value for the <em>fixed count</em> kind.</dd>
        <dt>step <span class="property-type">number</span></dt>
        <dd>Step value for the <em>fixed count</em> type.</dd>
        <dt>limit <span class="property-type">number</span></dt>
        <dd>Limits the total time (in milliseconds) for looping.</dd>
        <dt>command <span class="property-type">string</span></dt>
        <dd>Controls the loop. <code>break</code> causes to stop looping. <code>restart</code> starts looping again from the first value.</dd>
    </dl>
    <h3>Output</h3>
    <ol class="node-ports">
         <li>end of loop
             <dl class="message-properties">
                 <dt>payload <span class="property-type">any</span></dt>
                 <dd>Depends on <strong>End Payload</strong> property.</dd>
             </dl>
             <dl class="message-properties">
                 <dt>loop <span class="property-type">object</span></dt>
                 <dd><ul>
                     <li><code>broken</code> – true, when the loop have been broken by <code>break</code> command (see command input)</li>
                     <li><code>timeout</code> – true, when the loop have been broken due to exeeding time limit</li>
                     <li><code>passed.total</code> – the total number of passes hrought the loop</li>
                     <li><code>passed.last</code> – number of passes through the loop from the last restart or start</li>
                     <li><code>restarts</code> – number of the restarts by <code>restart</code> command (see command input)</li>
                 </ul></dd>
             </dl>
         <li>pass of loop
             <dl class="message-properties">
                 <dt>payload <span class="property-type">any</span></dt>
                 <dd>Depends on <strong>Loop Payload</strong> property.</dd>
             </dl>
             <dl class="message-properties">
                 <dt>loop <span class="property-type">object</span></dt>
                 <dd><ul>
                     <li><code>index</code> – index of the current loop.</li>
                     <li><code>value</code> – value of the current loop (based on initial/step values for <em>fixed loop</em> kind, undefined for <em>condition</em> kind and iterable item value for <em>enumeration</em> kind).</li>
                     <li><code>key</code> – key of the current loop (for <em>enumeration</em> kind and Object or Map only)</li>
                     <li><code>count</code> – the total number of loops (for <em>fixed count</em> kind)</li>
                     <li><code>initial</code> – initial value (for <em>fixed count</em> kind)</li>
                     <li><code>step</code> – step value (for <em>fixed count</em> kind)</li>
                     <li><code>enumeration</code> – the iterable object (for <em>enumeration</em> kind)</li>
                 </ul></dd>
             </dl>
         </li>
    </ol>
    <h3>Details</h3>
    <p>Your nodes can change the msg.loop properties, but it doesn’t affect the loop. Your nodes may not create a brush new msg object in the loop as loop integrity is based on the messige ID.</p>
    <p>JavaScript based condition should be expression with the last part evaluated to boolean. Example: <code>msg.payload &gt; 10 &amp;&amp; msg.status</code>.</p>
    <p>JSONata based condition should be expression avaluated to boolean. Example: <code>msg.name in $globalContext('data')</code>.</p>
    <p>RegExp based condition is used for match by test() on msg.payload. Example: <code>^Device[0-9]: .*</code></p>
    <h3>References</h3>
    <ul>
        <li>Official <a href="https://gitlab.com/advantech-czech/node-red-contrib-loop/-/tree/1.0.1">documentation</a> on Gitlab.</li>
        <li><a href="https://jsonata.org/">JSONata</a> query and transforming language official web.</li>
        <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">Regular Expressions</a> basics on Mozilla.</li>
    </ul>
</script>
